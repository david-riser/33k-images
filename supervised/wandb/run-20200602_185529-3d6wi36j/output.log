                                                file label
0  ARAV/2_ARAV_e247928c9aa729f933ce062bdb627acba0...  ARAV
1  ARAV/2_ARAV_239963e5a812c030f3ef961f2acc431346...  ARAV
2  ARAV/2_ARAV_b1a69c6f318196018dabff10cd43878c92...  ARAV
3  ARAV/2_ARAV_4c31e54363350bdbfc387ba370f9dd0b8c...  ARAV
4  ARAV/2_ARAV_0acbd579bc7e5ed7fba5ce20c334a4ff27...  ARAV
                                                file label
0  ARAV/2_ARAV_13684f41eb8a7126a9d574d09c51f76266...  ARAV
1  ARAV/2_ARAV_6053972b6ff2d524597b22f7b3a784736e...  ARAV
2  ARAV/2_ARAV_eed15e77cf4d9dff8797e208689a35d95f...  ARAV
3  ARAV/2_ARAV_7f42d22656ec3701265d8e2a18fa713b62...  ARAV
4  ARAV/2_ARAV_7f18c05dbef9e03122647e4ea85b58f9ff...  ARAV
[DEBUG] Input shape: (224, 224, 3), Output shape: 7
Found 9164 validated image filenames belonging to 7 classes.
Found 1140 validated image filenames belonging to 7 classes.
WARNING:tensorflow:From main.py:194: Model.fit_generator (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
Please use Model.fit, which supports generators.
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
Train for 50 steps, validate for 72 steps
 1/50 [..............................] - ETA: 4:26 - loss: 2.6283 - accuracy: 0.0000e+00 - top_3_cat_acc: 0.0625 - precision: 0.0000e+00 - recall: 0.0000e+00 2/50 [>.............................] - ETA: 2:13 - loss: 10.7523 - accuracy: 0.2500 - top_3_cat_acc: 0.4062 - precision: 0.5000 - recall: 0.2500            3/50 [>.............................] - ETA: 1:28 - loss: 21.3347 - accuracy: 0.2500 - top_3_cat_acc: 0.4583 - precision: 0.3750 - recall: 0.2500 4/50 [=>............................] - ETA: 1:06 - loss: 19.6707 - accuracy: 0.1875 - top_3_cat_acc: 0.5156 - precision: 0.2500 - recall: 0.1875 5/50 [==>...........................] - ETA: 52s - loss: 16.4487 - accuracy: 0.2875 - top_3_cat_acc: 0.5750 - precision: 0.3594 - recall: 0.2875  6/50 [==>...........................] - ETA: 43s - loss: 14.5412 - accuracy: 0.3125 - top_3_cat_acc: 0.5938 - precision: 0.3750 - recall: 0.3125 7/50 [===>..........................] - ETA: 37s - loss: 13.1902 - accuracy: 0.3036 - top_3_cat_acc: 0.6339 - precision: 0.3542 - recall: 0.3036 8/50 [===>..........................] - ETA: 32s - loss: 12.3421 - accuracy: 0.3203 - top_3_cat_acc: 0.6172 - precision: 0.3661 - recall: 0.3203 9/50 [====>.........................] - ETA: 28s - loss: 11.1605 - accuracy: 0.3403 - top_3_cat_acc: 0.6181 - precision: 0.3984 - recall: 0.340310/50 [=====>........................] - ETA: 25s - loss: 10.2547 - accuracy: 0.3438 - top_3_cat_acc: 0.6187 - precision: 0.4060 - recall: 0.337511/50 [=====>........................] - ETA: 23s - loss: 9.5922 - accuracy: 0.3409 - top_3_cat_acc: 0.6307 - precision: 0.4014 - recall: 0.3352 12/50 [======>.......................] - ETA: 21s - loss: 8.8395 - accuracy: 0.3802 - top_3_cat_acc: 0.6615 - precision: 0.4417 - recall: 0.375013/50 [======>.......................] - ETA: 19s - loss: 8.3309 - accuracy: 0.3942 - top_3_cat_acc: 0.6635 - precision: 0.4545 - recall: 0.384614/50 [=======>......................] - ETA: 17s - loss: 7.8346 - accuracy: 0.4152 - top_3_cat_acc: 0.6741 - precision: 0.4764 - recall: 0.406215/50 [========>.....................] - ETA: 16s - loss: 7.4327 - accuracy: 0.4167 - top_3_cat_acc: 0.6708 - precision: 0.4900 - recall: 0.408316/50 [========>.....................] - ETA: 15s - loss: 7.0983 - accuracy: 0.4219 - top_3_cat_acc: 0.6758 - precision: 0.4907 - recall: 0.410217/50 [=========>....................] - ETA: 13s - loss: 6.7435 - accuracy: 0.4338 - top_3_cat_acc: 0.6801 - precision: 0.5089 - recall: 0.419118/50 [=========>....................] - ETA: 12s - loss: 6.4158 - accuracy: 0.4479 - top_3_cat_acc: 0.6910 - precision: 0.5214 - recall: 0.423619/50 [==========>...................] - ETA: 12s - loss: 6.1641 - accuracy: 0.4539 - top_3_cat_acc: 0.7007 - precision: 0.5224 - recall: 0.421120/50 [===========>..................] - ETA: 11s - loss: 5.9249 - accuracy: 0.4625 - top_3_cat_acc: 0.7031 - precision: 0.5349 - recall: 0.431321/50 [===========>..................] - ETA: 10s - loss: 5.7017 - accuracy: 0.4643 - top_3_cat_acc: 0.7113 - precision: 0.5351 - recall: 0.431522/50 [============>.................] - ETA: 9s - loss: 5.4988 - accuracy: 0.4688 - top_3_cat_acc: 0.7131 - precision: 0.5461 - recall: 0.4375 23/50 [============>.................] - ETA: 9s - loss: 5.2704 - accuracy: 0.4918 - top_3_cat_acc: 0.7255 - precision: 0.5676 - recall: 0.456524/50 [=============>................] - ETA: 8s - loss: 5.0979 - accuracy: 0.5000 - top_3_cat_acc: 0.7266 - precision: 0.5761 - recall: 0.463525/50 [==============>...............] - ETA: 8s - loss: 5.0002 - accuracy: 0.4950 - top_3_cat_acc: 0.7275 - precision: 0.5662 - recall: 0.460026/50 [==============>...............] - ETA: 7s - loss: 4.8555 - accuracy: 0.5000 - top_3_cat_acc: 0.7284 - precision: 0.5723 - recall: 0.466327/50 [===============>..............] - ETA: 7s - loss: 4.7555 - accuracy: 0.5000 - top_3_cat_acc: 0.7315 - precision: 0.5722 - recall: 0.467628/50 [===============>..............] - ETA: 6s - loss: 4.7130 - accuracy: 0.4955 - top_3_cat_acc: 0.7210 - precision: 0.5699 - recall: 0.464329/50 [================>.............] - ETA: 6s - loss: 4.5747 - accuracy: 0.5043 - top_3_cat_acc: 0.7306 - precision: 0.5767 - recall: 0.469830/50 [=================>............] - ETA: 5s - loss: 4.4983 - accuracy: 0.4979 - top_3_cat_acc: 0.7333 - precision: 0.5689 - recall: 0.464631/50 [=================>............] - ETA: 5s - loss: 4.4077 - accuracy: 0.4960 - top_3_cat_acc: 0.7319 - precision: 0.5689 - recall: 0.457732/50 [==================>...........] - ETA: 4s - loss: 4.3228 - accuracy: 0.4961 - top_3_cat_acc: 0.7383 - precision: 0.5690 - recall: 0.459033/50 [==================>...........] - ETA: 4s - loss: 4.2393 - accuracy: 0.4981 - top_3_cat_acc: 0.7424 - precision: 0.5701 - recall: 0.454534/50 [===================>..........] - ETA: 4s - loss: 4.1574 - accuracy: 0.5000 - top_3_cat_acc: 0.7463 - precision: 0.5724 - recall: 0.457735/50 [====================>.........] - ETA: 3s - loss: 4.0530 - accuracy: 0.5107 - top_3_cat_acc: 0.7518 - precision: 0.5817 - recall: 0.464336/50 [====================>.........] - ETA: 3s - loss: 3.9568 - accuracy: 0.5191 - top_3_cat_acc: 0.7569 - precision: 0.5913 - recall: 0.472237/50 [=====================>........] - ETA: 3s - loss: 3.8899 - accuracy: 0.5203 - top_3_cat_acc: 0.7568 - precision: 0.5932 - recall: 0.473038/50 [=====================>........] - ETA: 2s - loss: 3.8195 - accuracy: 0.5247 - top_3_cat_acc: 0.7632 - precision: 0.5967 - recall: 0.477039/50 [======================>.......] - ETA: 2s - loss: 3.7379 - accuracy: 0.5304 - top_3_cat_acc: 0.7692 - precision: 0.6012 - recall: 0.480840/50 [=======================>......] - ETA: 2s - loss: 3.6824 - accuracy: 0.5297 - top_3_cat_acc: 0.7672 - precision: 0.6031 - recall: 0.479741/50 [=======================>......] - ETA: 2s - loss: 3.6337 - accuracy: 0.5305 - top_3_cat_acc: 0.7668 - precision: 0.6054 - recall: 0.481742/50 [========================>.....] - ETA: 1s - loss: 3.5579 - accuracy: 0.5402 - top_3_cat_acc: 0.7708 - precision: 0.6157 - recall: 0.491143/50 [========================>.....] - ETA: 1s - loss: 3.4921 - accuracy: 0.5465 - top_3_cat_acc: 0.7733 - precision: 0.6209 - recall: 0.492744/50 [=========================>....] - ETA: 1s - loss: 3.4286 - accuracy: 0.5526 - top_3_cat_acc: 0.7784 - precision: 0.6243 - recall: 0.495745/50 [==========================>...] - ETA: 1s - loss: 3.3636 - accuracy: 0.5569 - top_3_cat_acc: 0.7833 - precision: 0.6300 - recall: 0.501446/50 [==========================>...] - ETA: 0s - loss: 3.3120 - accuracy: 0.5584 - top_3_cat_acc: 0.7880 - precision: 0.6299 - recall: 0.504147/50 [===========================>..] - ETA: 0s - loss: 3.2495 - accuracy: 0.5665 - top_3_cat_acc: 0.7926 - precision: 0.6368 - recall: 0.510648/50 [===========================>..] - ETA: 0s - loss: 3.2043 - accuracy: 0.5716 - top_3_cat_acc: 0.7969 - precision: 0.6408 - recall: 0.515649/50 [============================>.] - ETA: 0s - loss: 3.1512 - accuracy: 0.5778 - top_3_cat_acc: 0.7997 - precision: 0.6444 - recall: 0.517950/50 [==============================] - 30s 593ms/step - loss: 3.1103 - accuracy: 0.5763 - top_3_cat_acc: 0.8025 - precision: 0.6439 - recall: 0.5175 - val_loss: 2.7913 - val_accuracy: 0.5219 - val_top_3_cat_acc: 0.8246 - val_precision: 0.5313 - val_recall: 0.5132
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
Train for 50 steps, validate for 72 steps
 1/50 [..............................] - ETA: 6:12 - loss: 1.3992 - accuracy: 0.5000 - top_3_cat_acc: 0.8750 - precision: 0.6154 - recall: 0.5000 2/50 [>.............................] - ETA: 3:09 - loss: 1.7055 - accuracy: 0.5312 - top_3_cat_acc: 0.8125 - precision: 0.6071 - recall: 0.5312 3/50 [>.............................] - ETA: 2:08 - loss: 1.8192 - accuracy: 0.5625 - top_3_cat_acc: 0.8125 - precision: 0.6341 - recall: 0.5417 4/50 [=>............................] - ETA: 1:37 - loss: 1.4929 - accuracy: 0.6250 - top_3_cat_acc: 0.8438 - precision: 0.6909 - recall: 0.5938 5/50 [==>...........................] - ETA: 1:18 - loss: 1.5437 - accuracy: 0.6250 - top_3_cat_acc: 0.8000 - precision: 0.6857 - recall: 0.6000 6/50 [==>...........................] - ETA: 1:06 - loss: 1.4522 - accuracy: 0.6250 - top_3_cat_acc: 0.8125 - precision: 0.6747 - recall: 0.5833 7/50 [===>..........................] - ETA: 57s - loss: 1.3345 - accuracy: 0.6429 - top_3_cat_acc: 0.8304 - precision: 0.6939 - recall: 0.6071  8/50 [===>..........................] - ETA: 50s - loss: 1.2275 - accuracy: 0.6797 - top_3_cat_acc: 0.8438 - precision: 0.7232 - recall: 0.6328 9/50 [====>.........................] - ETA: 45s - loss: 1.2149 - accuracy: 0.6667 - top_3_cat_acc: 0.8542 - precision: 0.7087 - recall: 0.625010/50 [=====>........................] - ETA: 40s - loss: 1.2084 - accuracy: 0.6625 - top_3_cat_acc: 0.8500 - precision: 0.7092 - recall: 0.625011/50 [=====>........................] - ETA: 37s - loss: 1.1966 - accuracy: 0.6648 - top_3_cat_acc: 0.8523 - precision: 0.7143 - recall: 0.625012/50 [======>.......................] - ETA: 34s - loss: 1.1506 - accuracy: 0.6667 - top_3_cat_acc: 0.8542 - precision: 0.7246 - recall: 0.630213/50 [======>.......................] - ETA: 31s - loss: 1.1859 - accuracy: 0.6587 - top_3_cat_acc: 0.8606 - precision: 0.7127 - recall: 0.620214/50 [=======>......................] - ETA: 29s - loss: 1.1588 - accuracy: 0.6696 - top_3_cat_acc: 0.8705 - precision: 0.7165 - recall: 0.620515/50 [========>.....................] - ETA: 27s - loss: 1.1013 - accuracy: 0.6833 - top_3_cat_acc: 0.8792 - precision: 0.7321 - recall: 0.637516/50 [========>.....................] - ETA: 25s - loss: 1.0892 - accuracy: 0.6875 - top_3_cat_acc: 0.8750 - precision: 0.7309 - recall: 0.636717/50 [=========>....................] - ETA: 23s - loss: 1.1213 - accuracy: 0.6801 - top_3_cat_acc: 0.8676 - precision: 0.7257 - recall: 0.632418/50 [=========>....................] - ETA: 22s - loss: 1.1057 - accuracy: 0.6806 - top_3_cat_acc: 0.8715 - precision: 0.7262 - recall: 0.635419/50 [==========>...................] - ETA: 20s - loss: 1.0793 - accuracy: 0.6908 - top_3_cat_acc: 0.8783 - precision: 0.7331 - recall: 0.641420/50 [===========>..................] - ETA: 19s - loss: 1.0689 - accuracy: 0.6875 - top_3_cat_acc: 0.8750 - precision: 0.7374 - recall: 0.640621/50 [===========>..................] - ETA: 18s - loss: 1.0538 - accuracy: 0.6935 - top_3_cat_acc: 0.8810 - precision: 0.7397 - recall: 0.642922/50 [============>.................] - ETA: 17s - loss: 1.0817 - accuracy: 0.6847 - top_3_cat_acc: 0.8807 - precision: 0.7311 - recall: 0.633523/50 [============>.................] - ETA: 16s - loss: 1.0982 - accuracy: 0.6821 - top_3_cat_acc: 0.8777 - precision: 0.7250 - recall: 0.630424/50 [=============>................] - ETA: 15s - loss: 1.1028 - accuracy: 0.6797 - top_3_cat_acc: 0.8750 - precision: 0.7267 - recall: 0.630225/50 [==============>...............] - ETA: 14s - loss: 1.0936 - accuracy: 0.6825 - top_3_cat_acc: 0.8725 - precision: 0.7320 - recall: 0.635026/50 [==============>...............] - ETA: 13s - loss: 1.0894 - accuracy: 0.6827 - top_3_cat_acc: 0.8750 - precision: 0.7361 - recall: 0.637027/50 [===============>..............] - ETA: 12s - loss: 1.0747 - accuracy: 0.6829 - top_3_cat_acc: 0.8773 - precision: 0.7392 - recall: 0.636628/50 [===============>..............] - ETA: 12s - loss: 1.0578 - accuracy: 0.6830 - top_3_cat_acc: 0.8817 - precision: 0.7429 - recall: 0.638429/50 [================>.............] - ETA: 11s - loss: 1.0426 - accuracy: 0.6853 - top_3_cat_acc: 0.8815 - precision: 0.7469 - recall: 0.642230/50 [=================>............] - ETA: 10s - loss: 1.0527 - accuracy: 0.6812 - top_3_cat_acc: 0.8813 - precision: 0.7427 - recall: 0.637531/50 [=================>............] - ETA: 9s - loss: 1.0498 - accuracy: 0.6815 - top_3_cat_acc: 0.8810 - precision: 0.7476 - recall: 0.6391 32/50 [==================>...........] - ETA: 9s - loss: 1.0296 - accuracy: 0.6875 - top_3_cat_acc: 0.8828 - precision: 0.7534 - recall: 0.644533/50 [==================>...........] - ETA: 8s - loss: 1.0374 - accuracy: 0.6837 - top_3_cat_acc: 0.8826 - precision: 0.7506 - recall: 0.638334/50 [===================>..........] - ETA: 8s - loss: 1.0256 - accuracy: 0.6857 - top_3_cat_acc: 0.8842 - precision: 0.7516 - recall: 0.639735/50 [====================>.........] - ETA: 7s - loss: 1.0066 - accuracy: 0.6929 - top_3_cat_acc: 0.8875 - precision: 0.7573 - recall: 0.646436/50 [====================>.........] - ETA: 6s - loss: 0.9966 - accuracy: 0.6962 - top_3_cat_acc: 0.8889 - precision: 0.7622 - recall: 0.651037/50 [=====================>........] - ETA: 6s - loss: 0.9827 - accuracy: 0.6993 - top_3_cat_acc: 0.8919 - precision: 0.7639 - recall: 0.650338/50 [=====================>........] - ETA: 5s - loss: 0.9693 - accuracy: 0.7039 - top_3_cat_acc: 0.8914 - precision: 0.7703 - recall: 0.656239/50 [======================>.......] - ETA: 5s - loss: 0.9564 - accuracy: 0.7083 - top_3_cat_acc: 0.8926 - precision: 0.7759 - recall: 0.660340/50 [=======================>......] - ETA: 4s - loss: 0.9444 - accuracy: 0.7109 - top_3_cat_acc: 0.8938 - precision: 0.7794 - recall: 0.662541/50 [=======================>......] - ETA: 4s - loss: 0.9371 - accuracy: 0.7134 - top_3_cat_acc: 0.8933 - precision: 0.7828 - recall: 0.664642/50 [========================>.....] - ETA: 3s - loss: 0.9326 - accuracy: 0.7158 - top_3_cat_acc: 0.8929 - precision: 0.7850 - recall: 0.668243/50 [========================>.....] - ETA: 3s - loss: 0.9264 - accuracy: 0.7166 - top_3_cat_acc: 0.8939 - precision: 0.7880 - recall: 0.670144/50 [=========================>....] - ETA: 2s - loss: 0.9119 - accuracy: 0.7202 - top_3_cat_acc: 0.8963 - precision: 0.7917 - recall: 0.674745/50 [==========================>...] - ETA: 2s - loss: 0.9179 - accuracy: 0.7194 - top_3_cat_acc: 0.8958 - precision: 0.7915 - recall: 0.675046/50 [==========================>...] - ETA: 1s - loss: 0.9089 - accuracy: 0.7215 - top_3_cat_acc: 0.8981 - precision: 0.7930 - recall: 0.676647/50 [===========================>..] - ETA: 1s - loss: 0.8952 - accuracy: 0.7261 - top_3_cat_acc: 0.9003 - precision: 0.7963 - recall: 0.680948/50 [===========================>..] - ETA: 0s - loss: 0.8937 - accuracy: 0.7266 - top_3_cat_acc: 0.9010 - precision: 0.7960 - recall: 0.681049/50 [============================>.] - ETA: 0s - loss: 0.8814 - accuracy: 0.7309 - top_3_cat_acc: 0.9031 - precision: 0.8003 - recall: 0.684950/50 [==============================] - 41s 826ms/step - loss: 0.8691 - accuracy: 0.7350 - top_3_cat_acc: 0.9050 - precision: 0.8047 - recall: 0.6900 - val_loss: 0.7283 - val_accuracy: 0.7588 - val_top_3_cat_acc: 0.9289 - val_precision: 0.8140 - val_recall: 0.7333
Traceback (most recent call last):
  File "main.py", line 264, in <module>
    wandb.log({'balanced_accuracy':balanced_accuracy_score(trues, preds)})
  File "/home/ubuntu/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages/sklearn/metrics/_classification.py", line 1855, in balanced_accuracy_score
    C = confusion_matrix(y_true, y_pred, sample_weight=sample_weight)
  File "/home/ubuntu/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages/sklearn/metrics/_classification.py", line 268, in confusion_matrix
    y_type, y_true, y_pred = _check_targets(y_true, y_pred)
  File "/home/ubuntu/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages/sklearn/metrics/_classification.py", line 90, in _check_targets
    "and {1} targets".format(type_true, type_pred))
ValueError: Classification metrics can't handle a mix of multiclass and continuous targets
