                                                file label
0  ARAV/2_ARAV_e247928c9aa729f933ce062bdb627acba0...  ARAV
1  ARAV/2_ARAV_239963e5a812c030f3ef961f2acc431346...  ARAV
2  ARAV/2_ARAV_b1a69c6f318196018dabff10cd43878c92...  ARAV
3  ARAV/2_ARAV_4c31e54363350bdbfc387ba370f9dd0b8c...  ARAV
4  ARAV/2_ARAV_0acbd579bc7e5ed7fba5ce20c334a4ff27...  ARAV
                                                file label
0  ARAV/2_ARAV_13684f41eb8a7126a9d574d09c51f76266...  ARAV
1  ARAV/2_ARAV_6053972b6ff2d524597b22f7b3a784736e...  ARAV
2  ARAV/2_ARAV_eed15e77cf4d9dff8797e208689a35d95f...  ARAV
3  ARAV/2_ARAV_7f42d22656ec3701265d8e2a18fa713b62...  ARAV
4  ARAV/2_ARAV_7f18c05dbef9e03122647e4ea85b58f9ff...  ARAV
[DEBUG] Input shape: (224, 224, 3), Output shape: 7
Found 9164 validated image filenames belonging to 7 classes.
Found 1140 validated image filenames belonging to 7 classes.
WARNING:tensorflow:From main.py:194: Model.fit_generator (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
Please use Model.fit, which supports generators.
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
Train for 50 steps, validate for 72 steps
 1/50 [..............................] - ETA: 4:23 - loss: 2.2258 - accuracy: 0.2500 - top_3_cat_acc: 0.3125 - precision: 0.0000e+00 - recall: 0.0000e+00 2/50 [>.............................] - ETA: 2:11 - loss: 4.3373 - accuracy: 0.4062 - top_3_cat_acc: 0.5625 - precision: 0.5000 - recall: 0.2812         3/50 [>.............................] - ETA: 1:27 - loss: 17.0164 - accuracy: 0.3125 - top_3_cat_acc: 0.5208 - precision: 0.3235 - recall: 0.2292 4/50 [=>............................] - ETA: 1:05 - loss: 17.0183 - accuracy: 0.2656 - top_3_cat_acc: 0.4844 - precision: 0.2600 - recall: 0.2031 5/50 [==>...........................] - ETA: 52s - loss: 15.9095 - accuracy: 0.2875 - top_3_cat_acc: 0.5000 - precision: 0.2879 - recall: 0.2375  6/50 [==>...........................] - ETA: 43s - loss: 14.6739 - accuracy: 0.2500 - top_3_cat_acc: 0.5312 - precision: 0.2439 - recall: 0.2083 7/50 [===>..........................] - ETA: 37s - loss: 13.4167 - accuracy: 0.2679 - top_3_cat_acc: 0.5446 - precision: 0.2653 - recall: 0.2321 8/50 [===>..........................] - ETA: 32s - loss: 12.1589 - accuracy: 0.2891 - top_3_cat_acc: 0.5547 - precision: 0.2920 - recall: 0.2578 9/50 [====>.........................] - ETA: 28s - loss: 10.9099 - accuracy: 0.3264 - top_3_cat_acc: 0.5972 - precision: 0.3413 - recall: 0.298610/50 [=====>........................] - ETA: 25s - loss: 9.9627 - accuracy: 0.3500 - top_3_cat_acc: 0.6250 - precision: 0.3688 - recall: 0.3250 11/50 [=====>........................] - ETA: 22s - loss: 9.1925 - accuracy: 0.3750 - top_3_cat_acc: 0.6364 - precision: 0.3974 - recall: 0.352312/50 [======>.......................] - ETA: 20s - loss: 8.6496 - accuracy: 0.3698 - top_3_cat_acc: 0.6302 - precision: 0.3941 - recall: 0.349013/50 [======>.......................] - ETA: 19s - loss: 8.0839 - accuracy: 0.3894 - top_3_cat_acc: 0.6490 - precision: 0.4185 - recall: 0.370214/50 [=======>......................] - ETA: 17s - loss: 7.6360 - accuracy: 0.4062 - top_3_cat_acc: 0.6607 - precision: 0.4350 - recall: 0.388415/50 [========>.....................] - ETA: 16s - loss: 7.2920 - accuracy: 0.4125 - top_3_cat_acc: 0.6667 - precision: 0.4439 - recall: 0.395816/50 [========>.....................] - ETA: 14s - loss: 6.9409 - accuracy: 0.4180 - top_3_cat_acc: 0.6719 - precision: 0.4558 - recall: 0.402317/50 [=========>....................] - ETA: 13s - loss: 6.7207 - accuracy: 0.4191 - top_3_cat_acc: 0.6765 - precision: 0.4564 - recall: 0.404418/50 [=========>....................] - ETA: 12s - loss: 6.3983 - accuracy: 0.4340 - top_3_cat_acc: 0.6875 - precision: 0.4724 - recall: 0.416719/50 [==========>...................] - ETA: 11s - loss: 6.1362 - accuracy: 0.4375 - top_3_cat_acc: 0.7007 - precision: 0.4776 - recall: 0.421120/50 [===========>..................] - ETA: 11s - loss: 5.9384 - accuracy: 0.4437 - top_3_cat_acc: 0.7094 - precision: 0.4823 - recall: 0.425021/50 [===========>..................] - ETA: 10s - loss: 5.7281 - accuracy: 0.4494 - top_3_cat_acc: 0.7143 - precision: 0.4915 - recall: 0.431522/50 [============>.................] - ETA: 9s - loss: 5.5156 - accuracy: 0.4631 - top_3_cat_acc: 0.7273 - precision: 0.5048 - recall: 0.4460 23/50 [============>.................] - ETA: 9s - loss: 5.3314 - accuracy: 0.4701 - top_3_cat_acc: 0.7310 - precision: 0.5107 - recall: 0.453824/50 [=============>................] - ETA: 8s - loss: 5.1984 - accuracy: 0.4714 - top_3_cat_acc: 0.7370 - precision: 0.5088 - recall: 0.453125/50 [==============>...............] - ETA: 7s - loss: 5.0521 - accuracy: 0.4800 - top_3_cat_acc: 0.7400 - precision: 0.5197 - recall: 0.462526/50 [==============>...............] - ETA: 7s - loss: 4.9197 - accuracy: 0.4832 - top_3_cat_acc: 0.7452 - precision: 0.5190 - recall: 0.459127/50 [===============>..............] - ETA: 6s - loss: 4.7675 - accuracy: 0.4931 - top_3_cat_acc: 0.7500 - precision: 0.5314 - recall: 0.469928/50 [===============>..............] - ETA: 6s - loss: 4.6366 - accuracy: 0.4955 - top_3_cat_acc: 0.7567 - precision: 0.5354 - recall: 0.473229/50 [================>.............] - ETA: 6s - loss: 4.5543 - accuracy: 0.4892 - top_3_cat_acc: 0.7608 - precision: 0.5294 - recall: 0.465530/50 [=================>............] - ETA: 5s - loss: 4.5241 - accuracy: 0.4812 - top_3_cat_acc: 0.7542 - precision: 0.5213 - recall: 0.458331/50 [=================>............] - ETA: 5s - loss: 4.4394 - accuracy: 0.4879 - top_3_cat_acc: 0.7581 - precision: 0.5274 - recall: 0.465732/50 [==================>...........] - ETA: 4s - loss: 4.3636 - accuracy: 0.4902 - top_3_cat_acc: 0.7598 - precision: 0.5298 - recall: 0.468833/50 [==================>...........] - ETA: 4s - loss: 4.2570 - accuracy: 0.4943 - top_3_cat_acc: 0.7633 - precision: 0.5365 - recall: 0.473534/50 [===================>..........] - ETA: 4s - loss: 4.1420 - accuracy: 0.5055 - top_3_cat_acc: 0.7702 - precision: 0.5489 - recall: 0.485335/50 [====================>.........] - ETA: 3s - loss: 4.0455 - accuracy: 0.5125 - top_3_cat_acc: 0.7768 - precision: 0.5576 - recall: 0.492936/50 [====================>.........] - ETA: 3s - loss: 3.9605 - accuracy: 0.5156 - top_3_cat_acc: 0.7795 - precision: 0.5619 - recall: 0.496537/50 [=====================>........] - ETA: 3s - loss: 3.8906 - accuracy: 0.5186 - top_3_cat_acc: 0.7838 - precision: 0.5632 - recall: 0.496638/50 [=====================>........] - ETA: 2s - loss: 3.8616 - accuracy: 0.5164 - top_3_cat_acc: 0.7796 - precision: 0.5595 - recall: 0.495139/50 [======================>.......] - ETA: 2s - loss: 3.8091 - accuracy: 0.5176 - top_3_cat_acc: 0.7804 - precision: 0.5606 - recall: 0.496840/50 [=======================>......] - ETA: 2s - loss: 3.7680 - accuracy: 0.5141 - top_3_cat_acc: 0.7781 - precision: 0.5603 - recall: 0.493841/50 [=======================>......] - ETA: 2s - loss: 3.7025 - accuracy: 0.5137 - top_3_cat_acc: 0.7820 - precision: 0.5615 - recall: 0.493942/50 [========================>.....] - ETA: 1s - loss: 3.6598 - accuracy: 0.5149 - top_3_cat_acc: 0.7827 - precision: 0.5608 - recall: 0.494043/50 [========================>.....] - ETA: 1s - loss: 3.6036 - accuracy: 0.5203 - top_3_cat_acc: 0.7834 - precision: 0.5667 - recall: 0.500044/50 [=========================>....] - ETA: 1s - loss: 3.5460 - accuracy: 0.5213 - top_3_cat_acc: 0.7884 - precision: 0.5675 - recall: 0.501445/50 [==========================>...] - ETA: 1s - loss: 3.4819 - accuracy: 0.5264 - top_3_cat_acc: 0.7903 - precision: 0.5739 - recall: 0.506946/50 [==========================>...] - ETA: 0s - loss: 3.4333 - accuracy: 0.5272 - top_3_cat_acc: 0.7908 - precision: 0.5754 - recall: 0.508247/50 [===========================>..] - ETA: 0s - loss: 3.3776 - accuracy: 0.5306 - top_3_cat_acc: 0.7952 - precision: 0.5777 - recall: 0.509348/50 [===========================>..] - ETA: 0s - loss: 3.3138 - accuracy: 0.5378 - top_3_cat_acc: 0.7995 - precision: 0.5864 - recall: 0.516949/50 [============================>.] - ETA: 0s - loss: 3.2597 - accuracy: 0.5395 - top_3_cat_acc: 0.8036 - precision: 0.5882 - recall: 0.519150/50 [==============================] - 30s 594ms/step - loss: 3.2078 - accuracy: 0.5437 - top_3_cat_acc: 0.8050 - precision: 0.5935 - recall: 0.5238 - val_loss: 1.3396 - val_accuracy: 0.6763 - val_top_3_cat_acc: 0.8921 - val_precision: 0.7090 - val_recall: 0.6561
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
Train for 50 steps, validate for 72 steps
 1/50 [..............................] - ETA: 6:01 - loss: 0.8515 - accuracy: 0.6875 - top_3_cat_acc: 0.8750 - precision: 0.9167 - recall: 0.6875 2/50 [>.............................] - ETA: 3:04 - loss: 0.9030 - accuracy: 0.7500 - top_3_cat_acc: 0.9062 - precision: 0.8462 - recall: 0.6875 3/50 [>.............................] - ETA: 2:04 - loss: 0.9341 - accuracy: 0.7292 - top_3_cat_acc: 0.9167 - precision: 0.8000 - recall: 0.6667 4/50 [=>............................] - ETA: 1:35 - loss: 0.8166 - accuracy: 0.7656 - top_3_cat_acc: 0.9375 - precision: 0.8302 - recall: 0.6875 5/50 [==>...........................] - ETA: 1:17 - loss: 0.7707 - accuracy: 0.7625 - top_3_cat_acc: 0.9375 - precision: 0.8462 - recall: 0.6875 6/50 [==>...........................] - ETA: 1:04 - loss: 0.8220 - accuracy: 0.7604 - top_3_cat_acc: 0.9271 - precision: 0.8250 - recall: 0.6875 7/50 [===>..........................] - ETA: 56s - loss: 0.7819 - accuracy: 0.7589 - top_3_cat_acc: 0.9375 - precision: 0.8387 - recall: 0.6964  8/50 [===>..........................] - ETA: 49s - loss: 0.7580 - accuracy: 0.7656 - top_3_cat_acc: 0.9453 - precision: 0.8411 - recall: 0.7031 9/50 [====>.........................] - ETA: 44s - loss: 0.7335 - accuracy: 0.7778 - top_3_cat_acc: 0.9514 - precision: 0.8500 - recall: 0.708310/50 [=====>........................] - ETA: 40s - loss: 0.7217 - accuracy: 0.7750 - top_3_cat_acc: 0.9500 - precision: 0.8485 - recall: 0.700011/50 [=====>........................] - ETA: 36s - loss: 0.7123 - accuracy: 0.7784 - top_3_cat_acc: 0.9489 - precision: 0.8446 - recall: 0.710212/50 [======>.......................] - ETA: 33s - loss: 0.7123 - accuracy: 0.7708 - top_3_cat_acc: 0.9479 - precision: 0.8491 - recall: 0.703113/50 [======>.......................] - ETA: 30s - loss: 0.7234 - accuracy: 0.7596 - top_3_cat_acc: 0.9471 - precision: 0.8421 - recall: 0.692314/50 [=======>......................] - ETA: 28s - loss: 0.7488 - accuracy: 0.7545 - top_3_cat_acc: 0.9420 - precision: 0.8370 - recall: 0.687515/50 [========>.....................] - ETA: 26s - loss: 0.7298 - accuracy: 0.7583 - top_3_cat_acc: 0.9417 - precision: 0.8376 - recall: 0.687516/50 [========>.....................] - ETA: 24s - loss: 0.7175 - accuracy: 0.7617 - top_3_cat_acc: 0.9453 - precision: 0.8373 - recall: 0.683617/50 [=========>....................] - ETA: 23s - loss: 0.7500 - accuracy: 0.7610 - top_3_cat_acc: 0.9375 - precision: 0.8402 - recall: 0.676518/50 [=========>....................] - ETA: 21s - loss: 0.7523 - accuracy: 0.7569 - top_3_cat_acc: 0.9375 - precision: 0.8298 - recall: 0.677119/50 [==========>...................] - ETA: 20s - loss: 0.7706 - accuracy: 0.7500 - top_3_cat_acc: 0.9309 - precision: 0.8252 - recall: 0.667820/50 [===========>..................] - ETA: 19s - loss: 0.7699 - accuracy: 0.7469 - top_3_cat_acc: 0.9281 - precision: 0.8224 - recall: 0.665621/50 [===========>..................] - ETA: 18s - loss: 0.7700 - accuracy: 0.7470 - top_3_cat_acc: 0.9256 - precision: 0.8296 - recall: 0.666722/50 [============>.................] - ETA: 17s - loss: 0.7726 - accuracy: 0.7443 - top_3_cat_acc: 0.9290 - precision: 0.8315 - recall: 0.659123/50 [============>.................] - ETA: 16s - loss: 0.7487 - accuracy: 0.7527 - top_3_cat_acc: 0.9321 - precision: 0.8401 - recall: 0.671224/50 [=============>................] - ETA: 15s - loss: 0.7315 - accuracy: 0.7604 - top_3_cat_acc: 0.9349 - precision: 0.8479 - recall: 0.682325/50 [==============>...............] - ETA: 14s - loss: 0.7405 - accuracy: 0.7525 - top_3_cat_acc: 0.9300 - precision: 0.8459 - recall: 0.672526/50 [==============>...............] - ETA: 13s - loss: 0.7317 - accuracy: 0.7524 - top_3_cat_acc: 0.9327 - precision: 0.8434 - recall: 0.673127/50 [===============>..............] - ETA: 12s - loss: 0.7414 - accuracy: 0.7500 - top_3_cat_acc: 0.9306 - precision: 0.8382 - recall: 0.671328/50 [===============>..............] - ETA: 11s - loss: 0.7472 - accuracy: 0.7478 - top_3_cat_acc: 0.9286 - precision: 0.8384 - recall: 0.671929/50 [================>.............] - ETA: 11s - loss: 0.7629 - accuracy: 0.7457 - top_3_cat_acc: 0.9246 - precision: 0.8342 - recall: 0.672430/50 [=================>............] - ETA: 10s - loss: 0.7632 - accuracy: 0.7417 - top_3_cat_acc: 0.9250 - precision: 0.8316 - recall: 0.668731/50 [=================>............] - ETA: 9s - loss: 0.7537 - accuracy: 0.7440 - top_3_cat_acc: 0.9274 - precision: 0.8300 - recall: 0.6694 32/50 [==================>...........] - ETA: 9s - loss: 0.7523 - accuracy: 0.7461 - top_3_cat_acc: 0.9258 - precision: 0.8345 - recall: 0.669933/50 [==================>...........] - ETA: 8s - loss: 0.7562 - accuracy: 0.7424 - top_3_cat_acc: 0.9280 - precision: 0.8302 - recall: 0.666734/50 [===================>..........] - ETA: 7s - loss: 0.7441 - accuracy: 0.7463 - top_3_cat_acc: 0.9301 - precision: 0.8352 - recall: 0.671035/50 [====================>.........] - ETA: 7s - loss: 0.7497 - accuracy: 0.7482 - top_3_cat_acc: 0.9304 - precision: 0.8337 - recall: 0.671436/50 [====================>.........] - ETA: 6s - loss: 0.7419 - accuracy: 0.7500 - top_3_cat_acc: 0.9323 - precision: 0.8323 - recall: 0.671937/50 [=====================>........] - ETA: 6s - loss: 0.7411 - accuracy: 0.7534 - top_3_cat_acc: 0.9324 - precision: 0.8347 - recall: 0.674038/50 [=====================>........] - ETA: 5s - loss: 0.7345 - accuracy: 0.7566 - top_3_cat_acc: 0.9342 - precision: 0.8357 - recall: 0.677639/50 [======================>.......] - ETA: 5s - loss: 0.7287 - accuracy: 0.7580 - top_3_cat_acc: 0.9343 - precision: 0.8379 - recall: 0.679540/50 [=======================>......] - ETA: 4s - loss: 0.7172 - accuracy: 0.7625 - top_3_cat_acc: 0.9359 - precision: 0.8407 - recall: 0.684441/50 [=======================>......] - ETA: 4s - loss: 0.7134 - accuracy: 0.7637 - top_3_cat_acc: 0.9375 - precision: 0.8393 - recall: 0.684542/50 [========================>.....] - ETA: 3s - loss: 0.7068 - accuracy: 0.7649 - top_3_cat_acc: 0.9390 - precision: 0.8415 - recall: 0.687543/50 [========================>.....] - ETA: 3s - loss: 0.6995 - accuracy: 0.7660 - top_3_cat_acc: 0.9404 - precision: 0.8422 - recall: 0.690444/50 [=========================>....] - ETA: 2s - loss: 0.6950 - accuracy: 0.7656 - top_3_cat_acc: 0.9403 - precision: 0.8438 - recall: 0.690345/50 [==========================>...] - ETA: 2s - loss: 0.6946 - accuracy: 0.7667 - top_3_cat_acc: 0.9417 - precision: 0.8443 - recall: 0.693146/50 [==========================>...] - ETA: 1s - loss: 0.6875 - accuracy: 0.7663 - top_3_cat_acc: 0.9429 - precision: 0.8418 - recall: 0.694347/50 [===========================>..] - ETA: 1s - loss: 0.6826 - accuracy: 0.7686 - top_3_cat_acc: 0.9428 - precision: 0.8433 - recall: 0.694148/50 [===========================>..] - ETA: 0s - loss: 0.6747 - accuracy: 0.7708 - top_3_cat_acc: 0.9440 - precision: 0.8438 - recall: 0.696649/50 [============================>.] - ETA: 0s - loss: 0.6683 - accuracy: 0.7730 - top_3_cat_acc: 0.9452 - precision: 0.8457 - recall: 0.699050/50 [==============================] - 41s 824ms/step - loss: 0.6591 - accuracy: 0.7763 - top_3_cat_acc: 0.9463 - precision: 0.8479 - recall: 0.7038 - val_loss: 0.7028 - val_accuracy: 0.7833 - val_top_3_cat_acc: 0.9351 - val_precision: 0.8248 - val_recall: 0.7596
Traceback (most recent call last):
  File "main.py", line 265, in <module>
    dev['pred'] = preds
  File "/home/ubuntu/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages/pandas/core/frame.py", line 2938, in __setitem__
    self._set_item(key, value)
  File "/home/ubuntu/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages/pandas/core/frame.py", line 3000, in _set_item
    value = self._sanitize_column(key, value)
  File "/home/ubuntu/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages/pandas/core/frame.py", line 3636, in _sanitize_column
    value = sanitize_index(value, self.index, copy=False)
  File "/home/ubuntu/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages/pandas/core/internals/construction.py", line 611, in sanitize_index
    raise ValueError("Length of values does not match length of index")
ValueError: Length of values does not match length of index
