                                                file label
0  ARAV/2_ARAV_e247928c9aa729f933ce062bdb627acba0...  ARAV
1  ARAV/2_ARAV_239963e5a812c030f3ef961f2acc431346...  ARAV
2  ARAV/2_ARAV_b1a69c6f318196018dabff10cd43878c92...  ARAV
3  ARAV/2_ARAV_4c31e54363350bdbfc387ba370f9dd0b8c...  ARAV
4  ARAV/2_ARAV_0acbd579bc7e5ed7fba5ce20c334a4ff27...  ARAV
                                                file label
0  ARAV/2_ARAV_13684f41eb8a7126a9d574d09c51f76266...  ARAV
1  ARAV/2_ARAV_6053972b6ff2d524597b22f7b3a784736e...  ARAV
2  ARAV/2_ARAV_eed15e77cf4d9dff8797e208689a35d95f...  ARAV
3  ARAV/2_ARAV_7f42d22656ec3701265d8e2a18fa713b62...  ARAV
4  ARAV/2_ARAV_7f18c05dbef9e03122647e4ea85b58f9ff...  ARAV
[DEBUG] Input shape: (224, 224, 3), Output shape: 7
Found 9164 validated image filenames belonging to 7 classes.
Found 1140 validated image filenames belonging to 7 classes.
WARNING:tensorflow:From main.py:194: Model.fit_generator (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
Please use Model.fit, which supports generators.
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
Train for 50 steps, validate for 72 steps
 1/50 [..............................] - ETA: 4:30 - loss: 2.1399 - accuracy: 0.0625 - top_3_cat_acc: 0.5625 - precision: 0.0000e+00 - recall: 0.0000e+00 2/50 [>.............................] - ETA: 2:15 - loss: 12.0609 - accuracy: 0.2500 - top_3_cat_acc: 0.5625 - precision: 0.4375 - recall: 0.2188        3/50 [>.............................] - ETA: 1:29 - loss: 14.7195 - accuracy: 0.1875 - top_3_cat_acc: 0.5000 - precision: 0.2581 - recall: 0.1667 4/50 [=>............................] - ETA: 1:07 - loss: 14.3670 - accuracy: 0.1562 - top_3_cat_acc: 0.5938 - precision: 0.1915 - recall: 0.1406 5/50 [==>...........................] - ETA: 53s - loss: 13.9042 - accuracy: 0.1375 - top_3_cat_acc: 0.6250 - precision: 0.1587 - recall: 0.1250  6/50 [==>...........................] - ETA: 44s - loss: 14.1219 - accuracy: 0.1667 - top_3_cat_acc: 0.5938 - precision: 0.1899 - recall: 0.1562 7/50 [===>..........................] - ETA: 37s - loss: 13.5678 - accuracy: 0.1607 - top_3_cat_acc: 0.5625 - precision: 0.1789 - recall: 0.1518 8/50 [===>..........................] - ETA: 33s - loss: 12.1633 - accuracy: 0.1875 - top_3_cat_acc: 0.6016 - precision: 0.2091 - recall: 0.1797 9/50 [====>.........................] - ETA: 29s - loss: 11.2562 - accuracy: 0.2222 - top_3_cat_acc: 0.6042 - precision: 0.2460 - recall: 0.215310/50 [=====>........................] - ETA: 26s - loss: 10.3403 - accuracy: 0.2438 - top_3_cat_acc: 0.6062 - precision: 0.2714 - recall: 0.237511/50 [=====>........................] - ETA: 23s - loss: 9.6200 - accuracy: 0.2614 - top_3_cat_acc: 0.6193 - precision: 0.2903 - recall: 0.2557 12/50 [======>.......................] - ETA: 21s - loss: 8.9961 - accuracy: 0.2812 - top_3_cat_acc: 0.6354 - precision: 0.3136 - recall: 0.276013/50 [======>.......................] - ETA: 19s - loss: 8.4406 - accuracy: 0.3077 - top_3_cat_acc: 0.6442 - precision: 0.3443 - recall: 0.302914/50 [=======>......................] - ETA: 17s - loss: 7.9223 - accuracy: 0.3304 - top_3_cat_acc: 0.6607 - precision: 0.3636 - recall: 0.321415/50 [========>.....................] - ETA: 16s - loss: 7.5589 - accuracy: 0.3333 - top_3_cat_acc: 0.6708 - precision: 0.3632 - recall: 0.320816/50 [========>.....................] - ETA: 15s - loss: 7.3590 - accuracy: 0.3281 - top_3_cat_acc: 0.6562 - precision: 0.3568 - recall: 0.316417/50 [=========>....................] - ETA: 14s - loss: 7.0113 - accuracy: 0.3382 - top_3_cat_acc: 0.6618 - precision: 0.3678 - recall: 0.327218/50 [=========>....................] - ETA: 13s - loss: 6.6493 - accuracy: 0.3681 - top_3_cat_acc: 0.6806 - precision: 0.3937 - recall: 0.347219/50 [==========>...................] - ETA: 12s - loss: 6.3896 - accuracy: 0.3783 - top_3_cat_acc: 0.6842 - precision: 0.4045 - recall: 0.355320/50 [===========>..................] - ETA: 11s - loss: 6.1268 - accuracy: 0.3844 - top_3_cat_acc: 0.7000 - precision: 0.4099 - recall: 0.362521/50 [===========>..................] - ETA: 10s - loss: 5.8660 - accuracy: 0.4048 - top_3_cat_acc: 0.7113 - precision: 0.4295 - recall: 0.381022/50 [============>.................] - ETA: 9s - loss: 5.6680 - accuracy: 0.4091 - top_3_cat_acc: 0.7159 - precision: 0.4387 - recall: 0.3864 23/50 [============>.................] - ETA: 9s - loss: 5.4459 - accuracy: 0.4239 - top_3_cat_acc: 0.7283 - precision: 0.4554 - recall: 0.402224/50 [=============>................] - ETA: 8s - loss: 5.2858 - accuracy: 0.4271 - top_3_cat_acc: 0.7318 - precision: 0.4588 - recall: 0.406225/50 [==============>...............] - ETA: 8s - loss: 5.1730 - accuracy: 0.4300 - top_3_cat_acc: 0.7300 - precision: 0.4620 - recall: 0.410026/50 [==============>...............] - ETA: 7s - loss: 5.0679 - accuracy: 0.4279 - top_3_cat_acc: 0.7332 - precision: 0.4595 - recall: 0.408727/50 [===============>..............] - ETA: 7s - loss: 4.9505 - accuracy: 0.4398 - top_3_cat_acc: 0.7361 - precision: 0.4727 - recall: 0.421328/50 [===============>..............] - ETA: 6s - loss: 4.8085 - accuracy: 0.4464 - top_3_cat_acc: 0.7388 - precision: 0.4836 - recall: 0.428629/50 [================>.............] - ETA: 6s - loss: 4.6739 - accuracy: 0.4569 - top_3_cat_acc: 0.7457 - precision: 0.4939 - recall: 0.439730/50 [=================>............] - ETA: 5s - loss: 4.5346 - accuracy: 0.4708 - top_3_cat_acc: 0.7542 - precision: 0.5059 - recall: 0.450031/50 [=================>............] - ETA: 5s - loss: 4.4294 - accuracy: 0.4738 - top_3_cat_acc: 0.7581 - precision: 0.5090 - recall: 0.453632/50 [==================>...........] - ETA: 4s - loss: 4.3531 - accuracy: 0.4688 - top_3_cat_acc: 0.7578 - precision: 0.5066 - recall: 0.449233/50 [==================>...........] - ETA: 4s - loss: 4.2440 - accuracy: 0.4811 - top_3_cat_acc: 0.7633 - precision: 0.5181 - recall: 0.460234/50 [===================>..........] - ETA: 4s - loss: 4.1401 - accuracy: 0.4926 - top_3_cat_acc: 0.7684 - precision: 0.5289 - recall: 0.470635/50 [====================>.........] - ETA: 3s - loss: 4.0912 - accuracy: 0.4929 - top_3_cat_acc: 0.7714 - precision: 0.5280 - recall: 0.471436/50 [====================>.........] - ETA: 3s - loss: 4.0056 - accuracy: 0.4965 - top_3_cat_acc: 0.7743 - precision: 0.5301 - recall: 0.474037/50 [=====================>........] - ETA: 3s - loss: 3.9240 - accuracy: 0.5051 - top_3_cat_acc: 0.7770 - precision: 0.5389 - recall: 0.479738/50 [=====================>........] - ETA: 3s - loss: 3.8485 - accuracy: 0.5082 - top_3_cat_acc: 0.7796 - precision: 0.5416 - recall: 0.481939/50 [======================>.......] - ETA: 2s - loss: 3.7916 - accuracy: 0.5064 - top_3_cat_acc: 0.7821 - precision: 0.5387 - recall: 0.479240/50 [=======================>......] - ETA: 2s - loss: 3.7510 - accuracy: 0.5031 - top_3_cat_acc: 0.7812 - precision: 0.5351 - recall: 0.476641/50 [=======================>......] - ETA: 2s - loss: 3.6989 - accuracy: 0.5015 - top_3_cat_acc: 0.7820 - precision: 0.5324 - recall: 0.475642/50 [========================>.....] - ETA: 1s - loss: 3.6229 - accuracy: 0.5074 - top_3_cat_acc: 0.7842 - precision: 0.5400 - recall: 0.482143/50 [========================>.....] - ETA: 1s - loss: 3.5431 - accuracy: 0.5189 - top_3_cat_acc: 0.7892 - precision: 0.5505 - recall: 0.491344/50 [=========================>....] - ETA: 1s - loss: 3.4868 - accuracy: 0.5227 - top_3_cat_acc: 0.7926 - precision: 0.5533 - recall: 0.494345/50 [==========================>...] - ETA: 1s - loss: 3.4276 - accuracy: 0.5250 - top_3_cat_acc: 0.7958 - precision: 0.5550 - recall: 0.497246/50 [==========================>...] - ETA: 0s - loss: 3.3822 - accuracy: 0.5299 - top_3_cat_acc: 0.7989 - precision: 0.5584 - recall: 0.500047/50 [===========================>..] - ETA: 0s - loss: 3.3407 - accuracy: 0.5332 - top_3_cat_acc: 0.7992 - precision: 0.5618 - recall: 0.501348/50 [===========================>..] - ETA: 0s - loss: 3.2855 - accuracy: 0.5378 - top_3_cat_acc: 0.8008 - precision: 0.5687 - recall: 0.506549/50 [============================>.] - ETA: 0s - loss: 3.2391 - accuracy: 0.5370 - top_3_cat_acc: 0.8010 - precision: 0.5696 - recall: 0.506450/50 [==============================] - 30s 598ms/step - loss: 3.2163 - accuracy: 0.5400 - top_3_cat_acc: 0.8012 - precision: 0.5730 - recall: 0.5100 - val_loss: 1.3216 - val_accuracy: 0.6781 - val_top_3_cat_acc: 0.9035 - val_precision: 0.7066 - val_recall: 0.6526
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
WARNING:tensorflow:sample_weight modes were coerced from
  ...
    to  
  ['...']
Train for 50 steps, validate for 72 steps
 1/50 [..............................] - ETA: 6:18 - loss: 0.7032 - accuracy: 0.8125 - top_3_cat_acc: 0.9375 - precision: 0.9167 - recall: 0.6875 2/50 [>.............................] - ETA: 3:12 - loss: 0.6836 - accuracy: 0.7500 - top_3_cat_acc: 0.9375 - precision: 0.8148 - recall: 0.6875 3/50 [>.............................] - ETA: 2:10 - loss: 0.8544 - accuracy: 0.7083 - top_3_cat_acc: 0.8958 - precision: 0.7442 - recall: 0.6667 4/50 [=>............................] - ETA: 1:38 - loss: 0.7576 - accuracy: 0.7344 - top_3_cat_acc: 0.9219 - precision: 0.7679 - recall: 0.6719 5/50 [==>...........................] - ETA: 1:19 - loss: 0.8188 - accuracy: 0.7125 - top_3_cat_acc: 0.9250 - precision: 0.7571 - recall: 0.6625 6/50 [==>...........................] - ETA: 1:07 - loss: 0.8794 - accuracy: 0.6979 - top_3_cat_acc: 0.9062 - precision: 0.7561 - recall: 0.6458 7/50 [===>..........................] - ETA: 58s - loss: 0.8620 - accuracy: 0.6875 - top_3_cat_acc: 0.9196 - precision: 0.7447 - recall: 0.6250  8/50 [===>..........................] - ETA: 51s - loss: 0.8111 - accuracy: 0.7188 - top_3_cat_acc: 0.9219 - precision: 0.7706 - recall: 0.6562 9/50 [====>.........................] - ETA: 45s - loss: 0.8165 - accuracy: 0.7083 - top_3_cat_acc: 0.9167 - precision: 0.7769 - recall: 0.652810/50 [=====>........................] - ETA: 41s - loss: 0.8181 - accuracy: 0.7063 - top_3_cat_acc: 0.9187 - precision: 0.7836 - recall: 0.656211/50 [=====>........................] - ETA: 37s - loss: 0.8108 - accuracy: 0.7102 - top_3_cat_acc: 0.9205 - precision: 0.7852 - recall: 0.664812/50 [======>.......................] - ETA: 34s - loss: 0.8427 - accuracy: 0.7083 - top_3_cat_acc: 0.9219 - precision: 0.7805 - recall: 0.666713/50 [======>.......................] - ETA: 31s - loss: 0.8150 - accuracy: 0.7212 - top_3_cat_acc: 0.9231 - precision: 0.7889 - recall: 0.682714/50 [=======>......................] - ETA: 29s - loss: 0.8135 - accuracy: 0.7321 - top_3_cat_acc: 0.9196 - precision: 0.7969 - recall: 0.683015/50 [========>.....................] - ETA: 27s - loss: 0.7678 - accuracy: 0.7458 - top_3_cat_acc: 0.9250 - precision: 0.8116 - recall: 0.700016/50 [========>.....................] - ETA: 25s - loss: 0.7598 - accuracy: 0.7539 - top_3_cat_acc: 0.9258 - precision: 0.8161 - recall: 0.710917/50 [=========>....................] - ETA: 23s - loss: 0.7806 - accuracy: 0.7500 - top_3_cat_acc: 0.9228 - precision: 0.8155 - recall: 0.698518/50 [=========>....................] - ETA: 22s - loss: 0.7587 - accuracy: 0.7535 - top_3_cat_acc: 0.9271 - precision: 0.8171 - recall: 0.697919/50 [==========>...................] - ETA: 21s - loss: 0.7604 - accuracy: 0.7500 - top_3_cat_acc: 0.9243 - precision: 0.8185 - recall: 0.697420/50 [===========>..................] - ETA: 19s - loss: 0.7491 - accuracy: 0.7531 - top_3_cat_acc: 0.9281 - precision: 0.8199 - recall: 0.696921/50 [===========>..................] - ETA: 18s - loss: 0.7384 - accuracy: 0.7560 - top_3_cat_acc: 0.9315 - precision: 0.8211 - recall: 0.696422/50 [============>.................] - ETA: 17s - loss: 0.7486 - accuracy: 0.7472 - top_3_cat_acc: 0.9318 - precision: 0.8094 - recall: 0.687523/50 [============>.................] - ETA: 16s - loss: 0.7556 - accuracy: 0.7473 - top_3_cat_acc: 0.9266 - precision: 0.8141 - recall: 0.690224/50 [=============>................] - ETA: 15s - loss: 0.7439 - accuracy: 0.7474 - top_3_cat_acc: 0.9271 - precision: 0.8185 - recall: 0.692725/50 [==============>...............] - ETA: 14s - loss: 0.7497 - accuracy: 0.7475 - top_3_cat_acc: 0.9250 - precision: 0.8214 - recall: 0.690026/50 [==============>...............] - ETA: 13s - loss: 0.7547 - accuracy: 0.7500 - top_3_cat_acc: 0.9255 - precision: 0.8200 - recall: 0.689927/50 [===============>..............] - ETA: 12s - loss: 0.7649 - accuracy: 0.7454 - top_3_cat_acc: 0.9259 - precision: 0.8110 - recall: 0.685228/50 [===============>..............] - ETA: 12s - loss: 0.7558 - accuracy: 0.7455 - top_3_cat_acc: 0.9286 - precision: 0.8105 - recall: 0.687529/50 [================>.............] - ETA: 11s - loss: 0.7544 - accuracy: 0.7435 - top_3_cat_acc: 0.9310 - precision: 0.8112 - recall: 0.685330/50 [=================>............] - ETA: 10s - loss: 0.7553 - accuracy: 0.7437 - top_3_cat_acc: 0.9312 - precision: 0.8144 - recall: 0.685431/50 [=================>............] - ETA: 10s - loss: 0.7476 - accuracy: 0.7460 - top_3_cat_acc: 0.9294 - precision: 0.8182 - recall: 0.689532/50 [==================>...........] - ETA: 9s - loss: 0.7463 - accuracy: 0.7441 - top_3_cat_acc: 0.9277 - precision: 0.8190 - recall: 0.6895 33/50 [==================>...........] - ETA: 8s - loss: 0.7354 - accuracy: 0.7481 - top_3_cat_acc: 0.9299 - precision: 0.8243 - recall: 0.693234/50 [===================>..........] - ETA: 8s - loss: 0.7414 - accuracy: 0.7426 - top_3_cat_acc: 0.9283 - precision: 0.8206 - recall: 0.689335/50 [====================>.........] - ETA: 7s - loss: 0.7339 - accuracy: 0.7446 - top_3_cat_acc: 0.9304 - precision: 0.8220 - recall: 0.692936/50 [====================>.........] - ETA: 6s - loss: 0.7363 - accuracy: 0.7431 - top_3_cat_acc: 0.9306 - precision: 0.8182 - recall: 0.687537/50 [=====================>........] - ETA: 6s - loss: 0.7374 - accuracy: 0.7399 - top_3_cat_acc: 0.9307 - precision: 0.8120 - recall: 0.685838/50 [=====================>........] - ETA: 5s - loss: 0.7424 - accuracy: 0.7385 - top_3_cat_acc: 0.9309 - precision: 0.8109 - recall: 0.684239/50 [======================>.......] - ETA: 5s - loss: 0.7410 - accuracy: 0.7388 - top_3_cat_acc: 0.9295 - precision: 0.8130 - recall: 0.682740/50 [=======================>......] - ETA: 4s - loss: 0.7328 - accuracy: 0.7406 - top_3_cat_acc: 0.9297 - precision: 0.8175 - recall: 0.685941/50 [=======================>......] - ETA: 4s - loss: 0.7261 - accuracy: 0.7439 - top_3_cat_acc: 0.9299 - precision: 0.8185 - recall: 0.687542/50 [========================>.....] - ETA: 3s - loss: 0.7166 - accuracy: 0.7470 - top_3_cat_acc: 0.9315 - precision: 0.8212 - recall: 0.690543/50 [========================>.....] - ETA: 3s - loss: 0.7053 - accuracy: 0.7529 - top_3_cat_acc: 0.9331 - precision: 0.8256 - recall: 0.694844/50 [=========================>....] - ETA: 2s - loss: 0.7175 - accuracy: 0.7486 - top_3_cat_acc: 0.9318 - precision: 0.8234 - recall: 0.688945/50 [==========================>...] - ETA: 2s - loss: 0.7058 - accuracy: 0.7542 - top_3_cat_acc: 0.9333 - precision: 0.8272 - recall: 0.691746/50 [==========================>...] - ETA: 1s - loss: 0.7011 - accuracy: 0.7568 - top_3_cat_acc: 0.9348 - precision: 0.8282 - recall: 0.694347/50 [===========================>..] - ETA: 1s - loss: 0.6936 - accuracy: 0.7580 - top_3_cat_acc: 0.9362 - precision: 0.8302 - recall: 0.695548/50 [===========================>..] - ETA: 0s - loss: 0.6903 - accuracy: 0.7565 - top_3_cat_acc: 0.9375 - precision: 0.8302 - recall: 0.694049/50 [============================>.] - ETA: 0s - loss: 0.7008 - accuracy: 0.7538 - top_3_cat_acc: 0.9349 - precision: 0.8250 - recall: 0.691350/50 [==============================] - 42s 830ms/step - loss: 0.7008 - accuracy: 0.7513 - top_3_cat_acc: 0.9362 - precision: 0.8214 - recall: 0.6900 - val_loss: 0.7142 - val_accuracy: 0.7825 - val_top_3_cat_acc: 0.9456 - val_precision: 0.8114 - val_recall: 0.7588
Traceback (most recent call last):
  File "main.py", line 265, in <module>
    dev['pred'] = preds
  File "/home/ubuntu/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages/pandas/core/frame.py", line 2938, in __setitem__
    self._set_item(key, value)
  File "/home/ubuntu/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages/pandas/core/frame.py", line 3000, in _set_item
    value = self._sanitize_column(key, value)
  File "/home/ubuntu/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages/pandas/core/frame.py", line 3636, in _sanitize_column
    value = sanitize_index(value, self.index, copy=False)
  File "/home/ubuntu/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages/pandas/core/internals/construction.py", line 611, in sanitize_index
    raise ValueError("Length of values does not match length of index")
ValueError: Length of values does not match length of index
